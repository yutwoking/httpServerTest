/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package httpServer_sample;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.ServerSocket;
import java.net.Socket;


public class Library {
    public static void main(String[] args) throws Exception {
        System.out.println("start server >>>");

        try(
        	ServerSocket server = new ServerSocket(80);
        	Socket socket = server.accept();
        	BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream(),"UTF-8"));
        	BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream()));
        	){

        }

        System.out.println("<<< end server");
    }

    public Request requestReceive(BufferedReader in) throws Exception {
    	String line = in.readLine();

    	String[] firstLine = line.split(" ",3);
    	Request request = new Request(firstLine[0], firstLine[1], firstLine[2]);

    	line =  in.readLine();
    	int contentLength = 0;
    	while (line != null && !line.isEmpty()) {
    		if (line.startsWith("Content-Length")) {
    			contentLength = Integer.parseInt(line.split(":")[1].trim());
    		}

    		String[] record = line.split(";",2);
    		request.addHeader(record[0], record[1]);
    		line = in.readLine();
    	}

    	if (0 < contentLength) {
    		char[] c = new char[contentLength];
    		in.read(c);
    		request.setBody(new String(c));
    	}

    	return request;
    }


}
